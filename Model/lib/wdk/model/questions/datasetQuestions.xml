<wdkModel>

  <questionSet name="DatasetQuestions" displayName="Search for Data sets">

    <!-- ************************************************************ -->
    <!-- SourceId -->  
    <!-- ************************************************************ -->

    <question name="AllDatasets"
      displayName="Data Sets"
      shortDisplayName="All DS"
      fullAnswer="true"
      queryRef="DatasetIds.AllDatasets"
      recordClassRef="DatasetRecordClasses.DatasetRecordClass"
      noSummaryOnSingleRecord="true">
      <attributesList sorting="eupath_release asc" />
      <description>
         Find all data sets.
      </description>
    </question>

    <question name="AllDatasetsAndUserDatasets"
      displayName="Data Sets"
      shortDisplayName="All DS"
      fullAnswer="true"
      queryRef="DatasetIds.AllDatasetsAndUserDatasets"
      recordClassRef="DatasetRecordClasses.DatasetRecordClass"
      noSummaryOnSingleRecord="true">
      <attributesList sorting="eupath_release asc" />
      <description>
         Find all data sets.
      </description>
    </question>

    <question name="AllUserDatasets"
      displayName="User Data Sets"
      shortDisplayName="All UDs"
      fullAnswer="true"
      queryRef="DatasetIds.AllUserDatasets"
      recordClassRef="DatasetRecordClasses.DatasetRecordClass"
      noSummaryOnSingleRecord="true">
      <attributesList sorting="eupath_release asc" />
      <description>
         Find all data sets.
      </description>
    </question>

    <question name="SitemapDatasets"
      displayName="Data Sets"
      shortDisplayName="Sitemap"
      fullAnswer="true"
      queryRef="DatasetIds.SitemapDatasets"
      recordClassRef="DatasetRecordClasses.DatasetRecordClass">
      <description>
         Find all data sets for use by sitemap.xml
      </description>
     <propertyList name="forSitemap"/>
    </question>


    <question name="MapStudiesForToolbar"  includeProjects="EuPathDB,UniDB,VectorBase"
      displayName="Studies to show in toolbar"
      shortDisplayName="Map Studies"
      fullAnswer="true"
      queryRef="DatasetIds.MapStudiesForToolbar"
      recordClassRef="DatasetRecordClasses.DatasetRecordClass"
      noSummaryOnSingleRecord="true">
      <attributesList sorting="eupath_release desc,category asc,primary_key asc" />
      <description>
         Find all data sets.
      </description>
    </question>


    <question name="Studies"
      displayName="Study summaries"
      shortDisplayName="Studies"
      fullAnswer="true"
      queryRef="DatasetIds.AllDatasets"
      recordClassRef="DatasetRecordClasses.DatasetRecordClass"
      noSummaryOnSingleRecord="true">
      <attributesList sorting="eupath_release desc,category asc,primary_key asc" />
      <description>
         Find all data sets.
      </description>
    </question>

    <question name="DatasetsByDatasetNames"
      displayName="Data Sets by dataset names"
      shortDisplayName="Search"
      fullAnswer="true"
      queryRef="DatasetIds.ByExternalDatabaseNames"
      recordClassRef="DatasetRecordClasses.DatasetRecordClass"
      noSummaryOnSingleRecord="true">
      <attributesList sorting="category asc" />
      <description>
         Find data sets that are associated with an attribute on record page (ex.SNP table, Winzeler profile graphs etc.) 
      </description>
    </question>

    <question name="DatasetsByReferenceName"
      displayName="Data Sets used to generate a table or result"
      shortDisplayName="Reference"
      fullAnswer="true"
      queryRef="DatasetIds.ByReferenceName"
      recordClassRef="DatasetRecordClasses.DatasetRecordClass"
      noSummaryOnSingleRecord="true">
      <attributesList sorting="category asc" />
      <description>
         Find data sets that are associated with an attribute on record page (ex.SNP table, Winzeler profile graphs etc.) 
      </description>
    </question>

    <question name="DatasetsByReferenceNameNoTaxon"
      displayName="Data Sets used in a search"
      shortDisplayName="RefNoTaxon"
      fullAnswer="true"
      queryRef="DatasetIds.ByReferenceNameNoTaxon"
      recordClassRef="DatasetRecordClasses.DatasetRecordClass"
      noSummaryOnSingleRecord="true">
      <attributesList sorting="category asc" />
      <description>
         Find data sets that are associated with an attribute on record page (ex.SNP table, Winzeler profile graphs etc.) 
      </description>
    </question>

    <question name="DatasetsByQuestionName"
      displayName="Data Sets used in a search"
      shortDisplayName="Search"
      fullAnswer="true"
      queryRef="DatasetIds.ByQuestionName"
      recordClassRef="DatasetRecordClasses.DatasetRecordClass"
      noSummaryOnSingleRecord="true">
      <attributesList sorting="display_name asc" />
      <description>
        Find data sets that are associated with a particular search.
      </description>
    </question>

    <question name="DatasetsById"
      displayName="Data Sets by ID"
      shortDisplayName="ID"
      fullAnswer="true"
      queryRef="DatasetIds.ById"
      recordClassRef="DatasetRecordClasses.DatasetRecordClass"
      noSummaryOnSingleRecord="true">
      <attributesList sorting="display_name asc" />
      <description>
         Find data sets by ID
      </description>
    </question>

    <question name="DatasetsByRecordClass"
      displayName="Data Sets used on a record page for an organism"
      shortDisplayName="Record"
      fullAnswer="true"
      queryRef="DatasetIds.ByRecordClass"
      recordClassRef="DatasetRecordClasses.DatasetRecordClass"
      noSummaryOnSingleRecord="true">
      <attributesList sorting="category asc" />
      <description>
         Find data sets that are associated with a particular record type and organism, to be used in an a record page.
      </description>
    </question>

    <question name="DatasetsByType"
      displayName="Data Sets used on a record page for a type"
      shortDisplayName="Type"
      fullAnswer="true"
      queryRef="DatasetIds.ByType"
      recordClassRef="DatasetRecordClasses.DatasetRecordClass"
      noSummaryOnSingleRecord="true">
      <attributesList sorting="category asc" />
      <description>
         Find data sets that are associated with a particular data set type.
      </description>
    </question>

    <question name="DatasetsByTypeAndSubtype"
      displayName="Data Sets used on a record page for a type and subtype"
      shortDisplayName="TypeAndSubtype"
      fullAnswer="true"
      queryRef="DatasetIds.ByTypeAndSubtype"
      recordClassRef="DatasetRecordClasses.DatasetRecordClass"
      noSummaryOnSingleRecord="true">
      <attributesList sorting="category asc" />
      <description>
         Find data sets that are associated with a particular data set type and subtype
      </description>
    </question>

    <question name="DatasetsByCategoryAndSubtype"
      displayName="Data Sets used on a record page for a category and subtype"
      shortDisplayName="CategoryAndSubtype"
      fullAnswer="true"
      queryRef="DatasetIds.ByCategoryAndSubtype"
      recordClassRef="DatasetRecordClasses.DatasetRecordClass"
      noSummaryOnSingleRecord="true">
      <description>
         Find data sets that are associated with a particular data set type and subtype
      </description>
    </question>

    <question name="DatasetsByCategoryAndOrganism"
      displayName="Data Sets by Category and organism"
      excludeProjects="MicrobiomeDB,ClinEpiDB"
      shortDisplayName="Category"
      fullAnswer="true"
      queryRef="DatasetIds.ByCategoryAndOrganism"
      recordClassRef="DatasetRecordClasses.DatasetRecordClass"
      noSummaryOnSingleRecord="true">
      <!-- TODO Add back "organism prefix" here -->
      <attributesList summary="newcategory,pmids,summary,contact" 
                      sorting="contact asc"
       />
      <description>
         Find data sets that are associated with a particular category and organism
      </description>
    </question>


    <question name="DatasetsByUserId"
      displayName="Data Sets study_access level based on user_id"
      shortDisplayName="StudyAccess"
      fullAnswer="true"
      queryRef="DatasetIds.ByUserId"
      recordClassRef="DatasetRecordClasses.DatasetRecordClass"
      includeProjects="ClinEpiDB"
      noSummaryOnSingleRecord="true">
      <attributesList summary="study_id, restriction_level" />
      <description>
         Find data sets that are associated with a particular data set type and subtype
      </description>
       <dynamicAttributes>
         <columnAttribute name="restriction_level" displayName="Study Access level"  align="left" />
         <columnAttribute name="study_id" displayName="Study Id"  align="left" />
      </dynamicAttributes>
    </question>

  <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <!-- Text search -->
  <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

    <question name="DatasetsByText"
        excludeProjects="MicrobiomeDB,ClinEpiDB"
        displayName="Text (keyword)"
        shortDisplayName="Text"
        queryRef="DatasetIds.DatasetsByText"
        recordClassRef="DatasetRecordClasses.DatasetRecordClass"
        noSummaryOnSingleRecord="true">

      <attributesList summary="contact,institution,max_score" sorting="max_score desc" /> 

      <summary>
        <![CDATA[
          Find data sets by keyword search. Use * as a wildcard
        ]]>
      </summary>

      <description>
        <![CDATA[
          Find data sets by keyword search. Use * as a wildcard
        ]]>
      </description>

      <dynamicAttributes>
        <columnAttribute name="max_score" displayName="Score" align="center">
          <reporter name="histogram" displayName="Histogram" scopes=""
              implementation="org.gusdb.wdk.model.report.reporter.HistogramAttributeReporter">
            <description>Display the histogram of the values of this attribute</description>
            <property name="type">int</property>
          </reporter>
        </columnAttribute>
      </dynamicAttributes>

    </question>

  <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <!-- search of Gene List -->
  <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

    <question name="DatasetsByGeneList"
      displayName="Data Sets by gene list"
      shortDisplayName="GeneList"
      fullAnswer="true"
      queryRef="DatasetIds.ByGeneList"
      recordClassRef="DatasetRecordClasses.DatasetRecordClass"
      noSummaryOnSingleRecord="true" 
      excludeProjects="MicrobiomeDB,ClinEpiDB,EuPathDB">
      <description>
         Find RNA Seq data sets with high change of expression in the provided gene list.
      </description>
      <attributesList
         summary="obser_ovelap,exp_overlap,fold_enrichment,percent_ul,percent_ds,p_value,contact,institution"
         sorting="p_value asc" />
       <dynamicAttributes>
         <columnAttribute name="obser_ovelap" displayName="# Overlapping Genes 1"  align="center" help="Number of overlapped genes identifiers from the input list that could be mapped to this dataset by checking for valid IDs or ortholog transform"/>
         <columnAttribute name="exp_overlap" displayName="Exp Overlap"  align="center" help="Number of genes identifiers in the input list but not in this dataset"/>
	 <columnAttribute name="fold_enrichment" displayName="Fold enrichment"  align="center" help="Number of genes identifiers not in the input list and  not in this dataset"/>
	 <columnAttribute name="percent_ul" displayName="Percent UL"  align="center" help="Number of genes identifiers not in the input list but in this dataset"/>
	 <columnAttribute name="percent_ds" displayName="Percent DS"  align="center" help="Number of genes identifiers not in the input list and  not in this dataset"/>
	 <columnAttribute name="p_value" displayName="Fisher's Exact Test P-Value"  align="center" help="fisher's exact test p value "/>

      </dynamicAttributes>

    </question>


  </questionSet>

  <questionSet name="LegacyDatasetQuestions" displayName="Search for Data sets"  excludeProjects="MicrobiomeDB,ClinEpiDB,EuPathDB">

    <question name="Datasets"
      displayName="All Legacy Datasets"
      shortDisplayName="Legacy Datasets"
      fullAnswer="true"
      queryRef="LegacyDatasetIds.AllDatasets"
      recordClassRef="DatasetRecordClasses.LegacyDataset"
      noSummaryOnSingleRecord="true">
      <description>
      </description>
    </question>

  </questionSet>
</wdkModel>
